
Require Import List.
Require Import Coq.FSets.FMapList.
Require Import list_ot.
Require Import bounding_boxes. (* for datapt *)
Require Import classify.

(*Module Import ListMap := FMapList.Make(ListOrderedType).*)

Import ListMap.
Import ListNotations.

(* shuffled ... *)
Definition IRIS_DATASET : (list datapt) := [[62; 28; 48; 18]; [58; 26; 40; 12]; [60; 22; 50; 15]; [73; 29; 63; 18]; [64; 32; 53; 23]; [50; 20; 35; 10]; [63; 34; 56; 24]; [50; 35; 16; 6]; [57; 28; 41; 13]; [60; 29; 45; 15]; [61; 30; 49; 18]; [58; 40; 12; 2]; [79; 38; 64; 20]; [63; 33; 47; 16]; [68; 30; 55; 21]; [46; 32; 14; 2]; [56; 27; 42; 13]; [64; 28; 56; 22]; [62; 22; 45; 15]; [49; 25; 45; 17]; [65; 30; 58; 22]; [48; 34; 16; 2]; [69; 31; 54; 21]; [50; 30; 16; 2]; [57; 29; 42; 13]; [43; 30; 11; 1]; [77; 28; 67; 20]; [61; 30; 46; 14]; [55; 24; 37; 10]; [52; 41; 15; 1]; [60; 27; 51; 16]; [53; 37; 15; 2]; [66; 30; 44; 14]; [49; 24; 33; 10]; [61; 28; 40; 13]; [57; 30; 42; 12]; [60; 34; 45; 16]; [72; 36; 61; 25]; [65; 30; 52; 20]; [51; 38; 16; 2]; [44; 32; 13; 2]; [57; 25; 50; 20]; [51; 35; 14; 2]; [56; 28; 49; 20]; [63; 23; 44; 13]; [61; 29; 47; 14]; [64; 31; 55; 18]; [77; 38; 67; 22]; [77; 26; 69; 23]; [68; 28; 48; 14]; [58; 27; 51; 19]; [52; 34; 14; 2]; [54; 37; 15; 2]; [51; 35; 14; 3]; [50; 33; 14; 2]; [52; 27; 39; 14]; [69; 31; 51; 23]; [63; 29; 56; 18]; [63; 25; 50; 19]; [50; 34; 16; 4]; [46; 34; 14; 3]; [59; 32; 48; 18]; [49; 31; 15; 1]; [55; 25; 40; 13]; [67; 33; 57; 21]; [56; 30; 45; 15]; [62; 34; 54; 23]; [65; 32; 51; 20]; [58; 27; 51; 19]; [50; 35; 13; 3]; [68; 32; 59; 23]; [54; 39; 13; 4]; [55; 42; 14; 2]; [69; 31; 49; 15]; [49; 31; 15; 1]; [67; 33; 57; 25]; [72; 30; 58; 16]; [63; 33; 60; 25]; [55; 35; 13; 2]; [48; 30; 14; 1]; [48; 31; 16; 2]; [65; 30; 55; 18]; [76; 30; 66; 21]; [54; 34; 17; 2]; [56; 30; 41; 13]; [55; 23; 40; 13]; [44; 29; 14; 2]; [59; 30; 51; 18]; [58; 27; 39; 12]; [52; 35; 15; 2]; [67; 31; 44; 14]; [58; 27; 41; 10]; [54; 30; 45; 15]; [48; 34; 19; 2]; [77; 30; 61; 23]; [57; 28; 45; 13]; [45; 23; 13; 3]; [46; 36; 10; 2]; [57; 44; 15; 4]; [50; 23; 33; 10]; [74; 28; 61; 19]; [61; 26; 56; 14]; [50; 36; 14; 2]; [67; 30; 52; 23]; [72; 32; 60; 18]; [50; 34; 15; 2]; [59; 30; 42; 15]; [63; 28; 51; 15]; [49; 31; 15; 1]; [60; 30; 48; 18]; [67; 30; 50; 17]; [64; 32; 45; 15]; [44; 30; 13; 2]; [50; 32; 12; 2]; [51; 34; 15; 2]; [63; 25; 49; 15]; [67; 31; 47; 15]; [51; 37; 15; 4]; [64; 27; 53; 19]; [54; 39; 17; 4]; [56; 25; 39; 11]; [61; 28; 47; 12]; [67; 25; 58; 18]; [57; 26; 35; 10]; [64; 28; 56; 21]; [47; 32; 13; 2]; [71; 30; 59; 21]; [66; 29; 46; 13]; [46; 31; 15; 2]; [69; 32; 57; 23]; [48; 30; 14; 3]; [57; 38; 17; 3]; [47; 32; 16; 2]; [51; 38; 19; 4]; [58; 28; 51; 24]; [63; 27; 49; 18]; [67; 31; 56; 24]; [60; 22; 40; 10]; [55; 24; 38; 11]; [51; 25; 30; 11]; [65; 28; 46; 15]; [64; 29; 43; 13]; [55; 26; 44; 12]; [56; 29; 36; 13]; [70; 32; 47; 14]; [62; 29; 43; 13]; [49; 30; 14; 2]; [51; 33; 17; 5]; [54; 34; 15; 4]; [51; 38; 15; 3]].

Definition IRIS_LABELTABLE : LabelTable := (add [62; 28; 48; 18] 2 (add [58; 26; 40; 12] 3 (add [60; 22; 50; 15] 2 (add [73; 29; 63; 18] 2 (add [64; 32; 53; 23] 2 (add [50; 20; 35; 10] 3 (add [63; 34; 56; 24] 2 (add [50; 35; 16; 6] 1 (add [57; 28; 41; 13] 3 (add [60; 29; 45; 15] 3 (add [61; 30; 49; 18] 2 (add [58; 40; 12; 2] 1 (add [79; 38; 64; 20] 2 (add [63; 33; 47; 16] 3 (add [68; 30; 55; 21] 2 (add [46; 32; 14; 2] 1 (add [56; 27; 42; 13] 3 (add [64; 28; 56; 22] 2 (add [62; 22; 45; 15] 3 (add [49; 25; 45; 17] 2 (add [65; 30; 58; 22] 2 (add [48; 34; 16; 2] 1 (add [69; 31; 54; 21] 2 (add [50; 30; 16; 2] 1 (add [57; 29; 42; 13] 3 (add [43; 30; 11; 1] 1 (add [77; 28; 67; 20] 2 (add [61; 30; 46; 14] 3 (add [55; 24; 37; 10] 3 (add [52; 41; 15; 1] 1 (add [60; 27; 51; 16] 3 (add [53; 37; 15; 2] 1 (add [66; 30; 44; 14] 3 (add [49; 24; 33; 10] 3 (add [61; 28; 40; 13] 3 (add [57; 30; 42; 12] 3 (add [60; 34; 45; 16] 3 (add [72; 36; 61; 25] 2 (add [65; 30; 52; 20] 2 (add [51; 38; 16; 2] 1 (add [44; 32; 13; 2] 1 (add [57; 25; 50; 20] 2 (add [51; 35; 14; 2] 1 (add [56; 28; 49; 20] 2 (add [63; 23; 44; 13] 3 (add [61; 29; 47; 14] 3 (add [64; 31; 55; 18] 2 (add [77; 38; 67; 22] 2 (add [77; 26; 69; 23] 2 (add [68; 28; 48; 14] 3 (add [58; 27; 51; 19] 2 (add [52; 34; 14; 2] 1 (add [54; 37; 15; 2] 1 (add [51; 35; 14; 3] 1 (add [50; 33; 14; 2] 1 (add [52; 27; 39; 14] 3 (add [69; 31; 51; 23] 2 (add [63; 29; 56; 18] 2 (add [63; 25; 50; 19] 2 (add [50; 34; 16; 4] 1 (add [46; 34; 14; 3] 1 (add [59; 32; 48; 18] 3 (add [49; 31; 15; 1] 1 (add [55; 25; 40; 13] 3 (add [67; 33; 57; 21] 2 (add [56; 30; 45; 15] 3 (add [62; 34; 54; 23] 2 (add [65; 32; 51; 20] 2 (add [58; 27; 51; 19] 2 (add [50; 35; 13; 3] 1 (add [68; 32; 59; 23] 2 (add [54; 39; 13; 4] 1 (add [55; 42; 14; 2] 1 (add [69; 31; 49; 15] 3 (add [49; 31; 15; 1] 1 (add [67; 33; 57; 25] 2 (add [72; 30; 58; 16] 2 (add [63; 33; 60; 25] 2 (add [55; 35; 13; 2] 1 (add [48; 30; 14; 1] 1 (add [48; 31; 16; 2] 1 (add [65; 30; 55; 18] 2 (add [76; 30; 66; 21] 2 (add [54; 34; 17; 2] 1 (add [56; 30; 41; 13] 3 (add [55; 23; 40; 13] 3 (add [44; 29; 14; 2] 1 (add [59; 30; 51; 18] 2 (add [58; 27; 39; 12] 3 (add [52; 35; 15; 2] 1 (add [67; 31; 44; 14] 3 (add [58; 27; 41; 10] 3 (add [54; 30; 45; 15] 3 (add [48; 34; 19; 2] 1 (add [77; 30; 61; 23] 2 (add [57; 28; 45; 13] 3 (add [45; 23; 13; 3] 1 (add [46; 36; 10; 2] 1 (add [57; 44; 15; 4] 1 (add [50; 23; 33; 10] 3 (add [74; 28; 61; 19] 2 (add [61; 26; 56; 14] 2 (add [50; 36; 14; 2] 1 (add [67; 30; 52; 23] 2 (add [72; 32; 60; 18] 2 (add [50; 34; 15; 2] 1 (add [59; 30; 42; 15] 3 (add [63; 28; 51; 15] 2 (add [49; 31; 15; 1] 1 (add [60; 30; 48; 18] 2 (add [67; 30; 50; 17] 3 (add [64; 32; 45; 15] 3 (add [44; 30; 13; 2] 1 (add [50; 32; 12; 2] 1 (add [51; 34; 15; 2] 1 (add [63; 25; 49; 15] 3 (add [67; 31; 47; 15] 3 (add [51; 37; 15; 4] 1 (add [64; 27; 53; 19] 2 (add [54; 39; 17; 4] 1 (add [56; 25; 39; 11] 3 (add [61; 28; 47; 12] 3 (add [67; 25; 58; 18] 2 (add [57; 26; 35; 10] 3 (add [64; 28; 56; 21] 2 (add [47; 32; 13; 2] 1 (add [71; 30; 59; 21] 2 (add [66; 29; 46; 13] 3 (add [46; 31; 15; 2] 1 (add [69; 32; 57; 23] 2 (add [48; 30; 14; 3] 1 (add [57; 38; 17; 3] 1 (add [47; 32; 16; 2] 1 (add [51; 38; 19; 4] 1 (add [58; 28; 51; 24] 2 (add [63; 27; 49; 18] 2 (add [67; 31; 56; 24] 2 (add [60; 22; 40; 10] 3 (add [55; 24; 38; 11] 3 (add [51; 25; 30; 11] 3 (add [65; 28; 46; 15] 3 (add [64; 29; 43; 13] 3 (add [55; 26; 44; 12] 3 (add [56; 29; 36; 13] 3 (add [70; 32; 47; 14] 3 (add [62; 29; 43; 13] 3 (add [49; 30; 14; 2] 1 (add [51; 33; 17; 5] 1 (add [54; 34; 15; 4] 1 (add [51; 38; 15; 3] 1 (empty nat))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))).
Compute (length IRIS_DATASET).


Definition TRAINING := firstn 120 IRIS_DATASET.
Definition TEST := skipn 120 IRIS_DATASET.

Compute firstn 5 IRIS_DATASET.

Definition CLASSIFIER : datapt -> option nat :=
  classify manhattan_dist 5 4 TRAINING IRIS_LABELTABLE.


Compute (CLASSIFIER [50; 30; 12; 2]).    (*    =  Some 1 *)
Compute (CLASSIFIER [67; 31; 56; 24]).   (*    =  Some 2 *)




Definition pair_diff :=
(fun pair => match pair with
                            | (None, None) => false
                            | (Some x, Some y) => negb (Nat.eqb x y)
                            | (_, _) => true
                            end).

Compute 
  List.filter pair_diff
   (List.map (fun t => 
     (find t IRIS_LABELTABLE,
      CLASSIFIER t)) TEST).


